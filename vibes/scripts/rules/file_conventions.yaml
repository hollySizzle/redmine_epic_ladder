# ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†è¦ç´„å®šç¾©
# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã—ã¦é©ç”¨ã•ã‚Œã‚‹è¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å®šç¾©ã—ã¾ã™
# ClaudeCodeãŒã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹éš›ã«ã€è¦ç´„ç¢ºèªã‚’ä¿ƒã—ã¾ã™

rules:
  # ===========================================
  # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„
  # ===========================================
  - name: "Vibesãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„"
    patterns:
      - "**/docs/**/*.md"
      - "**/vibes/docs/**/*.md"
      - "vibes/docs/**/*.md"
      - "**/*.md" # å…¨mdãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼ˆæœ€ã‚‚åŒ…æ‹¬çš„ï¼‰
      - "docs/**/*.md"
    severity: "block" # block: å®Œå…¨ãƒ–ãƒ­ãƒƒã‚¯, warn: è­¦å‘Šã®ã¿
    token_threshold: 15000 # é‡è¦ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„ã¯ä½ã„é–¾å€¤
    message: |
      ğŸ“‹ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/docs/rules/vibes_documentation_standards.md
      å¿…èª­: @vibes/docs/rules/INDEX.md (è¦ç´„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹)
      Code as DocumentåŸå‰‡ã«å¾“ã„ã€ä½œæ¥­ã‚’ç¶šã‘ã¦ãã ã•ã„

  # ===========================================
  # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…è¦ç´„ (Fat Model, Skinny Controller)
  # ===========================================

  # epic_gridå°‚ç”¨Modelè¦ç´„ (æœ€å„ªå…ˆ)
  - name: "epic_gridModelå®Ÿè£…è¦ç´„ (Fat Model)"
    patterns:
      - "**/app/models/epic_grid/**/*.rb"
      - "**/app/models/concerns/epic_grid/**/*.rb"
      - "**/app/models/issue.rb"
      - "**/app/models/project.rb"
      - "**/app/models/tracker_hierarchy.rb"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ epic_gridModelå®Ÿè£…å‰ã«è¦ç´„ã¨Fat ModelåŸå‰‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/rules/backend_standards.md (Fat ModelåŸå‰‡)
      å¿…èª­: @vibes/rules/technical_architecture_quickstart.md (ãƒ¬ã‚¤ãƒ¤ãƒ¼è²¬å‹™)
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)

      âœ… Modelã«å®Ÿè£…ã™ã¹ãã‚‚ã®:
      - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (Epicä½œæˆã€ã‚«ãƒ¼ãƒ‰ç§»å‹•ã€çµ±è¨ˆè¨ˆç®—ãªã©)
      - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼
      - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åˆ¶å¾¡ãƒ»N+1å¯¾ç­–

      âŒ Modelã«æ›¸ã„ã¦ã¯ã„ã‘ãªã„ã‚‚ã®:
      - HTTPå‡¦ç†ãƒ»JSONå¤‰æ› (Controllerè²¬å‹™)

  # epic_gridå°‚ç”¨Controllerè¦ç´„
  - name: "epic_gridControllerå®Ÿè£…è¦ç´„ (Skinny Controller)"
    patterns:
      - "**/app/controllers/epic_grid/**/*.rb"
      - "**/app/controllers/concerns/epic_grid_api_concern.rb"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ epic_gridControllerå®Ÿè£…å‰ã«è¦ç´„ã¨Skinny ControlleråŸå‰‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/rules/backend_standards.md (Skinny ControlleråŸå‰‡)
      å¿…èª­: @vibes/rules/technical_architecture_quickstart.md (ãƒ¬ã‚¤ãƒ¤ãƒ¼è²¬å‹™)
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)

      âœ… Controllerã«å®Ÿè£…ã™ã¹ãã‚‚ã®:
      - HTTPè¦æ±‚/å¿œç­”åˆ¶å¾¡ãƒ»æ¨©é™æ¤œè¨¼
      - **Modelãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—** (Serviceã§ã¯ãªã„)
      - JSONå¤‰æ›ãƒ»Strong Parameters

      âŒ Controllerã«æ›¸ã„ã¦ã¯ã„ã‘ãªã„ã‚‚ã®:
      - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (Modelè²¬å‹™)
      - ç›´æ¥DBæ“ä½œ (Modelè²¬å‹™)

      ç›®æ¨™: 10-30è¡Œç¨‹åº¦ã«åã‚ã‚‹

  # epic_gridå°‚ç”¨Serviceè¦ç´„ (åŸå‰‡ç¦æ­¢)
  - name: "epic_gridServiceå®Ÿè£…è¦ç´„ (å¤–éƒ¨APIé€£æºã®ã¿)"
    patterns:
      - "**/app/services/epic_grid/**/*.rb"
    severity: "block"
    token_threshold: 15000
    message: |
      âš ï¸ CRITICAL: Serviceå±¤ã¯åŸå‰‡ã¨ã—ã¦ä½œæˆç¦æ­¢ã§ã™
      å¿…èª­: @vibes/rules/backend_standards.md (Serviceæœ€å°é™åŸå‰‡)

      âŒ Serviceã«æ›¸ã„ã¦ã¯ã„ã‘ãªã„ã‚‚ã®:
      - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ â†’ Modelã«æ›¸ã
      - ãƒ‡ãƒ¼ã‚¿æ“ä½œ â†’ Modelã«æ›¸ã
      - çµ±è¨ˆè¨ˆç®— â†’ Modelã«æ›¸ã

      âœ… ä¾‹å¤–çš„ã«è¨±å¯ã•ã‚Œã‚‹å ´åˆ (ç¨€):
      - å¤–éƒ¨APIé€£æºã®ã¿ (OpenAIã€Slackç­‰)
      - ãã®å ´åˆã‚‚Modelã‹ã‚‰å‘¼ã³å‡ºã™è¨­è¨ˆã«ã™ã‚‹

      æ—¢å­˜Serviceå‰Šé™¤å¯¾è±¡:
      - CardMoveService â†’ Issue#move_to_cell
      - EpicCreationService â†’ Issue.create_epic
      - StatisticsCalculator â†’ Project#epic_grid_statistics
      - GridDataBuilder â†’ Project#epic_grid_grid_data

  # ===========================================
  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…è¦ç´„
  # ===========================================

  # CSS/SCSSå®Ÿè£…è¦ç´„
  - name: "CSS/SCSSå®Ÿè£…è¦ç´„"
    patterns:
      - "**/assets/javascripts/epic_grid/src/**/*.css"
      - "**/assets/javascripts/epic_grid/src/**/*.scss"
      - "**/assets/stylesheets/**/*.css"
      - "**/assets/stylesheets/**/*.scss"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ CSS/SCSSå®Ÿè£…å‰ã«CSSè¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/rules/css_standards.md (CSSè¦ç´„)

      âœ… CSSè¦ç´„ã®è¦ç‚¹:
      - pxæŒ‡å®šéæ¨å¥¨ â†’ ç›¸å¯¾å˜ä½ã¾ãŸã¯CSSå¤‰æ•°ã‚’ä½¿ç”¨
      - ãƒã‚¹ãƒˆæ§‹é€ æ¨å¥¨ â†’ å½±éŸ¿ç¯„å›²ã‚’æ˜ç¢ºã«ã™ã‚‹
      - marginéæ¨å¥¨ â†’ paddingã‚’å„ªå…ˆã—ã¦ä½¿ç”¨

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ168 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å…¨ä½“ï¼ˆåŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆè¦æ±‚ï¼‰
  - name: "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…è¦ç´„ï¼ˆåŒ…æ‹¬çš„ï¼‰"
    patterns:
      - "**/assets/javascripts/epic_grid/src/**/*.ts"
      - "**/assets/javascripts/epic_grid/src/**/*.tsx"
      - "**/assets/javascripts/epic_grid/src/**/*.js"
      - "**/assets/javascripts/epic_grid/src/**/*.jsx"
    severity: "block"
    token_threshold: 15000
    message: |
      âš ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ¤œå‡º

      ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰å¤‰æ›´å¾Œã¯ã€å¿…ãšå˜ä½“ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
      ãƒ†ã‚¹ãƒˆãªã—ã§ã®å®Œäº†å ±å‘Šã¯ç¦æ­¢ã§ã™ã€‚

      âœ… å¿…é ˆä½œæ¥­ï¼ˆå¤‰æ›´å®Œäº†å¾Œã™ãã«å®Ÿè¡Œï¼‰:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèª
      4. å¤±æ•—ãŒã‚ã‚‹å ´åˆã¯ä¿®æ­£ã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

      ğŸ“‹ é–¢é€£è¦ç´„:
      - @vibes/rules/testing_strategy.md (ãƒ†ã‚¹ãƒˆæˆ¦ç•¥)
      - @vibes/docs/INDEX.md (Code as DocumentåŸå‰‡)

  # TypeScriptå‹å®šç¾©ï¼ˆSSoTï¼‰
  - name: "TypeScriptå‹å®šç¾©ï¼ˆSSoTï¼‰"
    patterns:
      - "**/assets/javascripts/epic_grid/src/types/**/*.ts"
      - "**/assets/javascripts/epic_grid/src/types/normalized-api.ts"
      - "**/assets/javascripts/epic_grid/src/types/api-endpoints.ts"
    severity: "block"
    token_threshold: 12000
    message: |
      âš ï¸ CRITICAL: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ Single Source of Truth (SSoT) ã§ã™
      å¿…èª­: @vibes/rules/technical_architecture_quickstart.md (APIä»•æ§˜ç®¡ç†)
      å¿…èª­: @vibes/rules/ai_collaboration_redmine.md (SSoTå³å®ˆåŸå‰‡)
      å¿…èª­: @vibes/docs/INDEX.md (Code as DocumentåŸå‰‡)

      å‹å®šç¾©å¤‰æ›´ã¯å…¨ã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã—ã¾ã™ã€‚å¿…ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼ã«ç¢ºèªã—ã¦ã‹ã‚‰ä½œæ¥­ã‚’ç¶šã‘ã¦ãã ã•ã„

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
  - name: "Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…è¦ç´„"
    patterns:
      - "**/assets/javascripts/epic_grid/src/components/**/*.tsx"
      - "**/assets/javascripts/epic_grid/src/components/**/*.jsx"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…å‰ã«SSoTã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)
      å¿…èª­: @vibes/rules/technical_architecture_quickstart.md (æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
      å‚è€ƒ: @vibes/specs/ui/epic_grid_ui_design_spec.md (UIè¨­è¨ˆ)

      React 18ã€Zustandã€Pragmatic D&Dã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # Zustandã‚¹ãƒˆã‚¢å®Ÿè£…
  - name: "Zustandã‚¹ãƒˆã‚¢å®Ÿè£…è¦ç´„"
    patterns:
      - "**/assets/javascripts/epic_grid/src/store/**/*.ts"
      - "**/assets/javascripts/epic_grid/src/store/useStore.ts"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ Zustandã‚¹ãƒˆã‚¢å®Ÿè£…å‰ã«SSoTã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)
      å¿…èª­: @vibes/rules/technical_architecture_quickstart.md (Stateç®¡ç†)

      Normalized Stateæ§‹é€ ï¼ˆentities + grid indexï¼‰ã‚’ç¶­æŒã—ã¦ã‹ã‚‰ä½œæ¥­ã‚’ç¶šã‘ã¦ãã ã•ã„

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # MSWãƒ¢ãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©
  - name: "MSWãƒ¢ãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©å®Ÿè£…è¦ç´„"
    patterns:
      - "**/assets/javascripts/epic_grid/src/mocks/**/*.ts"
      - "**/assets/javascripts/epic_grid/src/mocks/handlers.ts"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ MSWãƒ¢ãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©å®Ÿè£…å‰ã«SSoTã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)
      å¿…èª­: @epic_grid/src/types/api-endpoints.ts (ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾© SSoT)
      å¿…èª­: @vibes/rules/testing_strategy.md (MSW + Vitestæˆ¦ç•¥)

      ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯å‹å®šç¾©ã«å®Œå…¨æº–æ‹ ã•ã›ã¦ãã ã•ã„

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # ===========================================
  # ãƒ†ã‚¹ãƒˆå®Ÿè£…è¦ç´„
  # ===========================================

  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰
  - name: "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆå®Ÿè£…è¦ç´„ï¼ˆVitestï¼‰"
    patterns:
      - "**/assets/javascripts/epic_grid/src/**/*.test.tsx"
      - "**/assets/javascripts/epic_grid/src/**/*.test.ts"
      - "**/assets/javascripts/epic_grid/vitest.config.ts"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆå®Ÿè£…å‰ã«è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/rules/testing_strategy.md (Vitest + MSWæˆ¦ç•¥)
      å¿…èª­: @vibes/docs/INDEX.md (Code as Document - ãƒ†ã‚¹ãƒˆãŒä»•æ§˜)
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)

      ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒä»•æ§˜æ›¸ã§ã™ã€‚ã‚«ãƒãƒ¬ãƒƒã‚¸è¦ä»¶ï¼ˆCritical 100%, å…¨ä½“85%ï¼‰ã‚’ç¶­æŒã—ã¦ãã ã•ã„

      âœ… å¤‰æ›´å¾Œã®å¿…é ˆä½œæ¥­:
      1. cd assets/javascripts/epic_grid
      2. npm test  # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ38 testsï¼‰
      3. ãƒ†ã‚¹ãƒˆå…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Š

  # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆRSpecï¼‰
  - name: "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆå®Ÿè£…è¦ç´„ï¼ˆRSpecï¼‰"
    patterns:
      - "**/spec/**/*_spec.rb"
      - "**/spec/models/epic_grid/**/*.rb"
      - "**/spec/services/epic_grid/**/*.rb"
      - "**/spec/requests/epic_grid/**/*.rb"
      - "**/spec/integration/epic_grid/**/*.rb"
      - "**/spec/system/epic_grid/**/*.rb"
      - "**/spec/rails_helper.rb"
      - "**/spec/spec_helper.rb"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆå®Ÿè£…å‰ã«è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/rules/testing_strategy.md (Pure Playwright + RSpecæˆ¦ç•¥)
      å¿…èª­: @vibes/docs/INDEX.md (Code as Document - ãƒ†ã‚¹ãƒˆãŒä»•æ§˜)
      å¿…èª­: @epic_grid/src/types/normalized-api.ts (APIå‹å®šç¾© SSoT)
      Pure Playwrightæ–¹å¼ï¼ˆCapybaraä¸ä½¿ç”¨ï¼‰ã€FactoryBotã€DatabaseCleanerã®ä½¿ç”¨ã‚’å¾¹åº•ã—ã¦ãã ã•ã„

  # E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
  - name: "E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…è¦ç´„ï¼ˆPlaywrightï¼‰"
    patterns:
      - "**/spec/system/**/*_spec.rb"
      - "**/playwright/**/*.spec.js"
      - "**/playwright.config.js"
    severity: "block"
    token_threshold: 15000
    message: |
      ğŸ“‹ E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…å‰ã«è¦ç´„ã¨Reference Testã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/docs/rules/backend_testing.md (E2Eãƒ†ã‚¹ãƒˆè©³ç´°ã‚¬ã‚¤ãƒ‰)
      å¿…èª­: @vibes/rules/testing_strategy.md (Pure Playwrightæˆ¦ç•¥)
      å‚è€ƒ: @vibes/specs/technical/grid_measurement_strategy.md (Gridæ¸¬å®š)
      å‚è€ƒ: spec/system/epic_grid/simple_e2e_spec.rb (Reference Test)

      ğŸ¯ æ–°è¦ãƒ†ã‚¹ãƒˆä½œæˆ: simple_e2e_spec.rb ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ç·¨é›†
      ğŸ” ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚: backend_testing.md ã®ã€Œãƒ‡ãƒãƒƒã‚°æ‰‹é †ã€å‚ç…§

      Pure Playwrightæ–¹å¼ï¼ˆCapybaraä¸ä½¿ç”¨ï¼‰ã§i18nã‚¨ãƒ©ãƒ¼ã‚’å›é¿ã—ã¦ãã ã•ã„

  # FactoryBotå®šç¾©
  - name: "FactoryBotå®šç¾©è¦ç´„"
    patterns:
      - "**/spec/factories/**/*.rb"
    severity: "warn"
    token_threshold: 15000
    message: |
      ğŸ“‹ FactoryBotå®šç¾©å®Ÿè£…å‰ã«è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å‚è€ƒ: @vibes/rules/testing_strategy.md (ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†)
      å‚è€ƒ: @vibes/rules/technical_architecture_quickstart.md (4å±¤éšå±¤)
      TrackerHierarchyï¼ˆEpicâ†’Featureâ†’UserStoryâ†’Task/Testï¼‰ã«æº–æ‹ ã—ãŸå®šç¾©ã‚’æ¨å¥¨ã—ã¾ã™

  # ===========================================
  # AIå”åƒè¦ç´„
  # ===========================================

  # AIå”åƒè¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
  - name: "AIå”åƒè¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ"
    patterns:
      - "**/vibes/docs/rules/ai_collaboration_redmine.md"
      - "**/vibes/scripts/rules/file_conventions.yaml"
    severity: "block"
    token_threshold: 12000
    message: |
      ğŸ“‹ AIå”åƒè¦ç´„ç·¨é›†å‰ã«é–¢é€£è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/docs/rules/vibes_documentation_standards.md
      å¿…èª­: @vibes/docs/rules/INDEX.md (è¦ç´„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹)
      æ¨©é™è¦å®šï¼ˆè‡ªç«‹å®Ÿè¡Œå¯/è¦ç›¸è«‡/çµ¶å¯¾ç¦æ­¢ï¼‰ã®æ•´åˆæ€§ã‚’ä¿ã£ã¦ãã ã•ã„

  # ===========================================
  # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
  # ===========================================

  # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¦ç´„
  - name: "ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ"
    patterns:
      - "**/vibes/docs/rules/technical_architecture_quickstart.md"
      - "**/vibes/docs/rules/backend_standards.md"
      - "**/vibes/docs/rules/testing_strategy.md"
    severity: "block"
    token_threshold: 12000
    message: |
      ğŸ“‹ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¦ç´„ç·¨é›†å‰ã«é–¢é€£è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„
      å¿…èª­: @vibes/docs/rules/vibes_documentation_standards.md
      å¿…èª­: @vibes/docs/rules/INDEX.md (è¦ç´„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹)
      å¿…èª­: @vibes/docs/rules/ai_collaboration_redmine.md (å”åƒè¦ç´„)
      Code as DocumentåŸå‰‡ã«å¾“ã„ã€è¦ç´„ã¯æœ€å°é™ã«ä¿ã£ã¦ãã ã•ã„

  # ===========================================
  # å»ƒæ­¢ã•ã‚ŒãŸè¦ç´„ï¼ˆå‚è€ƒç”¨ã‚³ãƒ¡ãƒ³ãƒˆï¼‰
  # ===========================================

  # ä»¥ä¸‹ã®è¦ç´„ã¯ Code as Document ç§»è¡Œã«ã‚ˆã‚Šå»ƒæ­¢ã•ã‚Œã¾ã—ãŸï¼š
  # - logics/ é…ä¸‹ã®APIä»•æ§˜æ›¸ â†’ @epic_grid/src/types/normalized-api.ts (SSoT) ã«çµ±åˆ
  # - logics/ é…ä¸‹ã®æ©Ÿèƒ½è¨­è¨ˆæ›¸ â†’ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ (*.test.tsx, *_spec.rb) ã«çµ±åˆ
  # - å€‹åˆ¥æ©Ÿèƒ½ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„ â†’ backend_standards.md ã«çµ±åˆ

# ===========================================
# ãƒ¡ã‚¿æƒ…å ±
# ===========================================
meta:
  version: "2.1.0"
  updated_at: "2025-10-02"
  description: "Code as Documentç§»è¡Œå¾Œã®æ–°è¦ç´„æ§‹æˆå¯¾å¿œï¼ˆSSoTå¼·åŒ–ã€è¦ç´„çµ±åˆã€89%ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‰Šæ¸›ï¼‰ + ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´å¾Œã®å¼·åˆ¶ãƒ†ã‚¹ãƒˆå®Ÿè¡Œè¦ç´„"
  migration_notes: |
    ## ä¸»ãªå¤‰æ›´ç‚¹ï¼ˆv1.3.0 â†’ v2.1.0ï¼‰

    ### v2.1.0 æ–°æ©Ÿèƒ½ï¼ˆ2025-10-02ï¼‰
    - **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´å¾Œã®å¼·åˆ¶ãƒ†ã‚¹ãƒˆå®Ÿè¡Œè¦ç´„** è¿½åŠ 
      - å…¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ« (*.ts, *.tsx, *.js, *.jsx) å¤‰æ›´æ™‚ã« `npm test` å®Ÿè¡Œã‚’å¿…é ˆåŒ–
      - TypeScriptå‹å®šç¾©ã€Reactã€Zustandã€MSWã€ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å…¨ã¦ã«é©ç”¨
      - ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã¯ä¿®æ­£ã—ã¦ã‹ã‚‰å®Œäº†å ±å‘Šã‚’å¼·åˆ¶
      - severity: "block" ã§å¾¹åº•ï¼ˆwarn â†’ block ã«å¤‰æ›´ï¼‰

    ### v2.0.0 ä¸»è¦å¤‰æ›´ï¼ˆ2025-10-02ï¼‰

    ### å‰Šé™¤ã•ã‚ŒãŸè¦ç´„
    - TrackerHierarchyå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ModelåŸå‰‡) ã«çµ±åˆ
    - ãƒ‡ãƒ¼ã‚¿æ§‹é€ çµ±è¨ˆã‚·ã‚¹ãƒ†ãƒ  â†’ backend_standards.md (ServiceåŸå‰‡) ã«çµ±åˆ
    - VersionManagementå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ServiceåŸå‰‡) ã«çµ±åˆ
    - AutoGenerationå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ServiceåŸå‰‡) ã«çµ±åˆ
    - epic_gridUIå®Ÿè£…è¦ç´„ â†’ å‰Šé™¤ï¼ˆå®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰
    - StateTransitionå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ServiceåŸå‰‡) ã«çµ±åˆ
    - ValidationGuardå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ServiceåŸå‰‡) ã«çµ±åˆ
    - APIIntegrationå®Ÿè£…è¦ç´„ â†’ backend_standards.md (ControlleråŸå‰‡) ã«çµ±åˆ
    - epic_gridHookå®Ÿè£…è¦ç´„ â†’ å‰Šé™¤ï¼ˆå®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰
    - Feature Cardé–¢é€£ â†’ å‰Šé™¤ï¼ˆå®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰
    - epic_grid Gridé–¢é€£ â†’ å‰Šé™¤ï¼ˆå®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰
    - å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–¢é€£ â†’ å‰Šé™¤ï¼ˆå®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰å‚ç…§ï¼‰
    - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰è©³ç´°è¨­è¨ˆæ›¸ â†’ å‰Šé™¤ï¼ˆlogics/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå»ƒæ­¢ï¼‰

    ### æ–°è¦è¿½åŠ ã•ã‚ŒãŸè¦ç´„
    - TypeScriptå‹å®šç¾©ï¼ˆSSoTï¼‰ - APIä»•æ§˜ã®å”¯ä¸€ã®çœŸå®Ÿ
    - Zustandã‚¹ãƒˆã‚¢å®Ÿè£…è¦ç´„ - Normalized Stateæ§‹é€ 
    - MSWãƒ¢ãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©å®Ÿè£…è¦ç´„ - APIå‹å®šç¾©æº–æ‹ 
    - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆè¦ç´„ï¼ˆVitestï¼‰ - Code as Document
    - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆè¦ç´„ï¼ˆRSpecï¼‰ - Code as Document

    ### çµ±åˆã•ã‚ŒãŸè¦ç´„
    - Controller + Service â†’ backend_standards.md (170è¡Œ)
    - å…¨ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ â†’ testing_strategy.md (180è¡Œ)
    - AIå”åƒè¦ç´„ â†’ ai_collaboration_redmine.md (120è¡Œ)

    ### çµæœ
    - è¦ç´„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: 1,856è¡Œ â†’ 1,028è¡Œ (44%å‰Šæ¸›)
    - å…¨ä½“ï¼ˆè¦ç´„+APIä»•æ§˜ï¼‰: 9,477è¡Œ â†’ 1,496è¡Œ (84%å‰Šæ¸›)
    - Code as DocumentåŒ–ã«ã‚ˆã‚Šã€å‹å®šç¾©ã¨ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒä»•æ§˜æ›¸ã¨ã—ã¦æ©Ÿèƒ½
