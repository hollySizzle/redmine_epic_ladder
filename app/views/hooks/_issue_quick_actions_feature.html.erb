<div class="epic-ladder-quick-actions" style="margin-top: 15px; padding: 12px 15px; border: 2px solid #4CAF50; background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); border-radius: 8px; box-shadow: 0 2px 4px rgba(76, 175, 80, 0.15);">
  <h3 style="margin: 0 0 10px 0; font-size: 14px; font-weight: bold; color: #2e7d32;">
    ✨ <%= l(:label_epic_ladder_quick_actions) %> <span style="font-size: 11px; font-weight: normal; color: #558b2f;">（推奨）</span>
  </h3>
  <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">
    <%= l(:text_epic_ladder_create_under_this_feature, issue: link_to("##{issue.id} #{issue.subject}", issue_path(issue))).html_safe %>
  </p>
  <div class="epic-grid-action-buttons">
    <%
      tracker_names = EpicLadder::TrackerHierarchy.tracker_names

      # トラッカーIDを取得
      user_story_tracker = Tracker.find_by(name: tracker_names[:user_story])

      # 共通パラメータ
      common_params = {
        controller: 'issues',
        action: 'new',
        project_id: project.identifier,
        back_url: issue_path(issue)
      }
    %>

    <% if user_story_tracker %>
      <%= link_to(
        l(:label_epic_ladder_create_user_story),
        common_params.merge(issue: {
          parent_issue_id: issue.id,
          tracker_id: user_story_tracker.id,
          fixed_version_id: issue.fixed_version_id,
          due_date: issue.fixed_version&.effective_date,
          subject: "#{issue.subject} - Story"
        }),
        class: 'icon icon-add'
      ) %>
    <% end %>
  </div>
</div>
