// Kanban Grid Layout Component Styles
// ワイヤーフレーム: GROUP_KANBAN_GRID準拠 (Epic行 × Version列)

.group_kanban_grid {
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: #f8f9fa;

  // GRID_HEADER
  .grid_header {
    background: #ffffff;
    border-bottom: 2px solid #e0e0e0;
    padding: 16px;
    flex-shrink: 0;

    // GRID_FILTERS
    .grid_filters {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-top: 12px;

      .filter_option {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #333;
        cursor: pointer;

        input[type="checkbox"] {
          margin: 0;
        }
      }

      .version_filter {
        padding: 6px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        background: white;
        min-width: 150px;

        &:focus {
          outline: none;
          border-color: #1976d2;
          box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);
        }
      }
    }
  }

  // GRID_MAIN
  .grid_main {
    flex: 1;
    overflow: hidden;
    position: relative;

    // COLUMN_HEADERS
    .column_headers {
      display: flex;
      background: #ffffff;
      border-bottom: 1px solid #e0e0e0;
      position: sticky;
      top: 0;
      z-index: 10;

      .epic_column_header {
        width: 250px;
        padding: 12px 16px;
        font-weight: 600;
        color: #333;
        border-right: 1px solid #e0e0e0;
        background: #fafafa;
        flex-shrink: 0;
      }

      .grid_column_header {
        min-width: 200px;
        flex: 1;
        padding: 12px 16px;
        border-right: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;

        &[data-column="todo"] {
          background: #f8f9fa;
        }

        &[data-column="in_progress"] {
          background: #fff3e0;
        }

        &[data-column="ready_for_test"] {
          background: #e3f2fd;
        }

        &[data-column="released"] {
          background: #e8f5e8;
        }

        .column_name {
          font-weight: 600;
          color: #333;
        }

        .column_count {
          font-size: 12px;
          color: #666;
          background: rgba(0, 0, 0, 0.1);
          padding: 2px 6px;
          border-radius: 10px;
        }
      }
    }

    // GRID_BODY
    .grid_body {
      height: calc(100vh - 200px);
      overflow-y: auto;
      overflow-x: auto;

      .grid_row {
        display: flex;
        min-height: 120px;
        border-bottom: 1px solid #e0e0e0;

        &:hover {
          background: rgba(0, 0, 0, 0.02);
        }

        // EPIC_CELL
        .epic_cell {
          width: 250px;
          padding: 16px;
          border-right: 1px solid #e0e0e0;
          background: #fafafa;
          flex-shrink: 0;
          display: flex;
          flex-direction: column;
          justify-content: space-between;

          .epic_info {
            .epic_id {
              font-size: 12px;
              color: #666;
              font-weight: 500;
            }

            .epic_title {
              font-size: 14px;
              font-weight: 600;
              color: #333;
              margin: 4px 0 8px 0;
              line-height: 1.3;
            }

            .epic_status {
              font-size: 11px;
              padding: 2px 8px;
              border-radius: 12px;
              background: #e0e0e0;
              color: #666;
              font-weight: 500;
            }
          }

          .epic_statistics {
            margin-top: 12px;

            .feature_count {
              font-size: 12px;
              color: #666;
              margin-bottom: 8px;
            }

            .epic_progress {
              .progress_bar {
                width: 100%;
                height: 6px;
                background: #e0e0e0;
                border-radius: 3px;
                overflow: hidden;

                // 進捗バーの色分け
                background: linear-gradient(90deg, #4caf50, #66bb6a);
              }
            }
          }
        }
      }
    }

    // VERSION_GRID_OVERLAY - バージョン割り当てモード
    .version_grid_overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.95);
      z-index: 100;
      overflow-y: auto;

      .version_row {
        display: flex;
        min-height: 120px;
        border-bottom: 1px solid #e0e0e0;

        .epic_cell_overlay {
          width: 250px;
          padding: 16px;
          border-right: 1px solid #e0e0e0;
          background: #f0f0f0;
          display: flex;
          align-items: center;

          .epic_title {
            font-weight: 600;
            color: #333;
          }
        }

        .version_cell {
          min-width: 200px;
          flex: 1;
          padding: 8px;
          border-right: 1px solid #e0e0e0;
          border: 2px dashed transparent;
          transition: all 0.2s ease;

          &.selected {
            border-color: #1976d2;
            background: rgba(25, 118, 210, 0.1);
          }

          &:hover {
            background: rgba(0, 0, 0, 0.05);
          }
        }
      }
    }

    // DRAG_OVERLAY
    .drag_overlay_item {
      pointer-events: none;
      transform: rotate(5deg);
      opacity: 0.9;
      z-index: 1000;

      .base_item_drag_overlay {
        padding: 4px 8px;
        background: #1976d2;
        color: white;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);

        &.task {
          background: #2196f3;
        }

        &.test {
          background: #ff9800;
        }

        &.bug {
          background: #f44336;
        }
      }
    }
  }

  // GRID_FOOTER
  .grid_footer {
    background: #ffffff;
    border-top: 1px solid #e0e0e0;
    padding: 12px 16px;
    flex-shrink: 0;

    .grid_statistics {
      display: flex;
      align-items: center;
      gap: 24px;
      font-size: 14px;
      color: #666;

      span {
        display: flex;
        align-items: center;
        gap: 4px;

        &::before {
          content: '';
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background: currentColor;
        }
      }

      .total_epics::before {
        background: #9c27b0;
      }

      .total_features::before {
        background: #2196f3;
      }

      .completion_ratio::before {
        background: #4caf50;
      }
    }
  }
}

// レスポンシブ対応
@media (max-width: 1200px) {
  .group_kanban_grid {
    .grid_main {
      .column_headers {
        .epic_column_header {
          width: 200px;
        }

        .grid_column_header {
          min-width: 150px;
        }
      }

      .grid_body {
        .grid_row {
          .epic_cell {
            width: 200px;
          }
        }
      }

      .version_grid_overlay {
        .version_row {
          .epic_cell_overlay {
            width: 200px;
          }

          .version_cell {
            min-width: 150px;
          }
        }
      }
    }
  }
}

@media (max-width: 768px) {
  .group_kanban_grid {
    .grid_header {
      padding: 12px;

      .grid_filters {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }
    }

    .grid_main {
      .column_headers {
        .epic_column_header {
          width: 150px;
          padding: 8px 12px;
        }

        .grid_column_header {
          min-width: 120px;
          padding: 8px 12px;

          .column_name {
            font-size: 12px;
          }
        }
      }

      .grid_body {
        .grid_row {
          min-height: 100px;

          .epic_cell {
            width: 150px;
            padding: 12px;

            .epic_info {
              .epic_title {
                font-size: 12px;
              }
            }
          }
        }
      }
    }

    .grid_footer {
      padding: 8px 12px;

      .grid_statistics {
        font-size: 12px;
        gap: 16px;
      }
    }
  }
}